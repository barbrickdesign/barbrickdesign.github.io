<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://barbrickdesign.github.io/">
    <meta name="twitter:title" content="BARBRICKDESIGN - Elite Web3 Hub">
    <meta name="twitter:description" content="Cutting-edge Web3 development and design solutions">
    <meta name="twitter:image" content="https://barbrickdesign.github.io/header.jpg">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://barbrickdesign.github.io/">
    <meta property="og:title" content="BARBRICKDESIGN - Elite Web3 Hub">
    <meta property="og:description" content="Cutting-edge Web3 development and design solutions">
    <meta property="og:image" content="https://barbrickdesign.github.io/header.jpg">
    <meta name="description" content="BARBRICKDESIGN - Elite Web3 Development and Design Hub">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self' https:; connect-src 'self' https:;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BARBRICKDESIGN - Investment Dashboard</title>
    <link rel="preload" href="" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="mobile-responsive.css"></noscript>
    <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@latest/lib/index.iife.min.js" defer></script>
    <script src="universal-wallet-auth.js" defer></script>
    <script src="auth-integration.js" defer></script>
    <script src="project-tokenomics.js" defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Orbitron', sans-serif;
            background: #000;
            color: #00ffff;
            min-height: 100vh;
        }
        
        .tron-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(0deg, transparent 24%, rgba(0,255,0,.03) 25%, rgba(0,255,0,.03) 26%, transparent 27%),
                linear-gradient(90deg, transparent 24%, rgba(0,255,0,.03) 25%, rgba(0,255,0,.03) 26%, transparent 27%);
            background-size: 50px 50px;
            animation: gridMove 20s linear infinite;
            z-index: -1;
        }
        
        @keyframes gridMove {
            0% { transform: perspective(500px) rotateX(60deg) translateZ(0); }
            100% { transform: perspective(500px) rotateX(60deg) translateZ(50px); }
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(180deg, rgba(0,255,0,0.1), transparent);
            border: 2px solid rgba(0,255,0,0.3);
            border-radius: 20px;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 3em;
            background: linear-gradient(90deg, #00ff00, #00ffff);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            letter-spacing: 4px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #00ff00;
            font-size: 1.2em;
            letter-spacing: 2px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(0,40,0,0.8), rgba(0,60,0,0.8));
            border: 2px solid rgba(0,255,0,0.3);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,255,0,0.3);
            border-color: #00ff00;
        }
        
        .stat-label {
            color: #8affff;
            font-size: 0.9em;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-value {
            font-size: 2.5em;
            font-weight: 900;
            color: #00ff00;
            text-shadow: 0 0 20px rgba(0,255,0,0.6);
        }
        
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .token-card {
            background: linear-gradient(135deg, rgba(0,30,0,0.9), rgba(0,50,0,0.9));
            border: 2px solid rgba(0,255,0,0.2);
            border-radius: 15px;
            padding: 25px;
            transition: all 0.4s;
            position: relative;
            overflow: hidden;
        }
        
        .token-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0,255,0,0.1), transparent);
            transition: left 0.5s;
        }
        
        .token-card:hover::before {
            left: 100%;
        }
        
        .token-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,255,0,0.4);
            border-color: #00ff00;
        }
        
        .token-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .token-name {
            font-size: 1.5em;
            font-weight: 700;
            color: #00ff00;
        }
        
        .token-symbol {
            font-size: 1.2em;
            color: #00ffff;
            background: rgba(0,255,255,0.1);
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid rgba(0,255,255,0.3);
        }
        
        .token-value {
            font-size: 2em;
            font-weight: 900;
            color: #00ff00;
            margin: 15px 0;
            text-shadow: 0 0 15px rgba(0,255,0,0.6);
        }
        
        .token-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        
        .metric {
            background: rgba(0,0,0,0.4);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(0,255,0,0.2);
        }
        
        .metric-label {
            font-size: 0.8em;
            color: #8affff;
            margin-bottom: 5px;
        }
        
        .metric-value {
            font-size: 1.1em;
            font-weight: 700;
            color: #00ff00;
        }
        
        .invest-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(90deg, #00ff00, #00ffff);
            color: #000;
            border: none;
            border-radius: 10px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1em;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
        }
        
        .invest-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(0,255,0,0.6);
        }
        
        .risk-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 700;
            margin-top: 10px;
        }
        
        .risk-low { background: rgba(0,255,0,0.2); color: #00ff00; border: 1px solid #00ff00; }
        .risk-medium-low { background: rgba(0,255,100,0.2); color: #00ff77; border: 1px solid #00ff77; }
        .risk-medium { background: rgba(255,255,0,0.2); color: #ffff00; border: 1px solid #ffff00; }
        .risk-medium-high { background: rgba(255,165,0,0.2); color: #ffa500; border: 1px solid #ffa500; }
        .risk-high { background: rgba(255,0,0,0.2); color: #ff0000; border: 1px solid #ff0000; }
        
        .loading {
            text-align: center;
            padding: 60px 20px;
            font-size: 1.5em;
            color: #00ff00;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid rgba(0,255,0,0.2);
            border-top-color: #00ff00;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        footer {
            margin-top: 60px;
            padding: 30px 20px;
            text-align: center;
            border-top: 2px solid rgba(0,255,0,0.3);
        }
        
        @media (max-width: 768px) {
            h1 { font-size: 2em; }
            .projects-grid { grid-template-columns: 1fr; }
            .token-metrics { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="tron-grid"></div>
    
    <div class="container">
        <header>
            <h1>💰 INVESTMENT DASHBOARD</h1>
            <p class="subtitle">BARBRICKDESIGN PROJECT TOKENS</p>
            <p style="margin-top: 15px; color: #8affff;">Crypto-Backed Investment Opportunities</p>
        </header>

        <div class="wallet-section" id="walletSection" style="display: none;">
            <h2 style="text-align: center; margin: 30px 0 20px 0;">💰 Your Wallet Holdings</h2>
            <div class="wallet-grid" id="walletGrid">
                <div class="wallet-card">
                    <div class="wallet-label">Connected Wallet</div>
                    <div class="wallet-value" id="connectedWallet">Not Connected</div>
                </div>
                <div class="wallet-card">
                    <div class="wallet-label">SOL Balance</div>
                    <div class="wallet-value" id="solBalance">0 SOL</div>
                </div>
                <div class="wallet-card">
                    <div class="wallet-label">Portfolio Value</div>
                    <div class="wallet-value" id="portfolioValue">$0</div>
                </div>
                <div class="wallet-card">
                    <div class="wallet-label">24h Change</div>
                    <div class="wallet-value" id="portfolioChange">+0%</div>
                </div>
            </div>
        </div>

        <h2 class="section-title" style="font-size: 2em; margin: 40px 0 20px 0;">📊 Market Data</h2>
        <div class="stats-grid" id="statsGrid">
            <div class="stat-card">
                <div class="stat-label">SOL Price</div>
                <div class="stat-value" id="solPrice">$0</div>
                <div class="stat-change" id="solChange">+0%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Market Cap</div>
                <div class="stat-value" id="marketCap">$0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">24h Volume</div>
                <div class="stat-value" id="volume24h">$0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Active Projects</div>
                <div class="stat-value" id="projectCount">0</div>
            </div>
        </div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p style="margin-top: 20px;">Analyzing projects and generating tokens...</p>
        </div>

        <div class="projects-grid" id="projectsGrid" style="display: none;"></div>

        <footer>
            <p style="color: #00ff00; font-size: 1.1em; margin-bottom: 10px;">
                All tokens created on pump.fun | Powered by Solana
            </p>
            <p style="color: #8affff; margin-bottom: 10px;">
                📊 Data Sources: <a href="https://www.coingecko.com" target="_blank" style="color: #00ffff;">CoinGecko API</a> (prices & market data), 
                <a href="https://solana.com" target="_blank" style="color: #00ffff;">Solana</a> (ecosystem data), 
                project-tokenomics.js (valuations)
            </p>
            <p style="color: #8affff;">
                <a href="index.html" style="color: #00ffff;">← Back to Hub</a> | 
                <a href="https://pump.fun" target="_blank" style="color: #00ffff;">Visit pump.fun</a>
            </p>
        </footer>
    </div>

    <script>
        // API Configuration
        const COINGECKO_API = 'https://api.coingecko.com/api/v3';
        const UPDATE_INTERVAL = 60000; // Update every 60 seconds
        let lastUpdateTime = null;

        // Add timestamp display
        function addTimestampDisplay() {
            const header = document.querySelector('header');
            const timestampDiv = document.createElement('div');
            timestampDiv.id = 'lastUpdate';
            timestampDiv.style.cssText = 'margin-top: 10px; font-size: 0.9em; color: #8affff;';
            timestampDiv.innerHTML = '⏱️ Last Updated: Loading...';
            header.appendChild(timestampDiv);
        }

        function updateTimestamp() {
            const now = new Date();
            lastUpdateTime = now;
            const timestampDiv = document.getElementById('lastUpdate');
            if (timestampDiv) {
                timestampDiv.innerHTML = `⏱️ Last Updated: ${now.toLocaleTimeString()} | 🔄 Auto-refresh in 60s`;
            }
        }

        // Fetch real-time crypto prices from CoinGecko
        async function fetchCryptoPrice(symbol) {
            try {
                // Map project symbols to CoinGecko IDs
                const coinMap = {
                    'SOL': 'solana',
                    'ETH': 'ethereum',
                    'BTC': 'bitcoin',
                    'MATIC': 'matic-network'
                };
                
                const coinId = coinMap[symbol] || 'solana';
                const response = await fetch(`${COINGECKO_API}/simple/price?ids=${coinId}&vs_currencies=usd&include_24hr_change=true`);
                
                if (!response.ok) throw new Error('API request failed');
                
                const data = await response.json();
                return {
                    price: data[coinId]?.usd || 0,
                    change24h: data[coinId]?.usd_24h_change || 0
                };
            } catch (error) {
                console.warn('Failed to fetch real-time price:', error);
                return { price: 0, change24h: 0 };
            }
        }

        // Fetch market data for Solana ecosystem
        async function fetchSolanaMarketData() {
            try {
                const response = await fetch(`${COINGECKO_API}/coins/solana`);
                if (!response.ok) throw new Error('Failed to fetch Solana data');
                
                const data = await response.json();
                return {
                    marketCap: data.market_data?.market_cap?.usd || 0,
                    volume24h: data.market_data?.total_volume?.usd || 0,
                    priceChange24h: data.market_data?.price_change_percentage_24h || 0
                };
            } catch (error) {
                console.warn('Failed to fetch Solana market data:', error);
                return { marketCap: 0, volume24h: 0, priceChange24h: 0 };
            }
        }

        // BarbrickDesign Projects Data
        const projects = [
            {
                name: 'Gem Bot Universe',
                slug: 'gem-bot-universe',
                description: '3D globe with Web3 features and MGC tracking',
                repo: 'mandem.os',
                category: 'web3-platform',
                linesOfCode: 15000,
                commits: 250,
                stars: 5,
                forks: 2,
                contributors: 3,
                complexity: 8,
                monthsActive: 12,
                isUnique: true,
                icon: '🌍',
                tags: ['web3', 'gaming', '3d', 'solana']
            },
            {
                name: 'Ember Terminal',
                slug: 'ember-terminal',
                description: 'Enhanced terminal with cyberpunk aesthetics',
                repo: 'ember-terminal',
                category: 'terminal',
                linesOfCode: 5000,
                commits: 120,
                stars: 3,
                forks: 1,
                contributors: 2,
                complexity: 6,
                monthsActive: 8,
                isUnique: true,
                icon: '🔥',
                tags: ['terminal', 'web3', 'ui']
            },
            {
                name: 'Mandem.OS',
                slug: 'mandem-os',
                description: 'Web3 terminal with MetaMask integration',
                repo: 'mandemos-app',
                category: 'web3-platform',
                linesOfCode: 12000,
                commits: 200,
                stars: 4,
                forks: 1,
                contributors: 2,
                complexity: 7,
                monthsActive: 10,
                isUnique: true,
                icon: '⚡',
                tags: ['web3', 'terminal', 'metamask']
            },
            {
                name: 'SOL Recovery',
                slug: 'sol-recovery',
                description: 'Reclaim SOL from empty token accounts',
                repo: 'SOLRecovery',
                category: 'utility',
                linesOfCode: 3000,
                commits: 80,
                stars: 2,
                forks: 0,
                contributors: 1,
                complexity: 4,
                monthsActive: 6,
                isUnique: true,
                icon: '💰',
                tags: ['solana', 'utility', 'recovery']
            },
            {
                name: 'Ghostmode',
                slug: 'ghostmode',
                description: 'QR code security and privacy tool',
                repo: 'RTghostmode',
                category: 'security-tool',
                linesOfCode: 4000,
                commits: 90,
                stars: 1,
                forks: 0,
                contributors: 1,
                complexity: 5,
                monthsActive: 5,
                isUnique: true,
                icon: '👻',
                tags: ['security', 'privacy', 'qr']
            },
            {
                name: 'SCAM TRACK',
                slug: 'scam-track',
                description: 'Track, trace, and take down scams',
                repo: 'rTSCAMTRACK',
                category: 'security-tool',
                linesOfCode: 6000,
                commits: 110,
                stars: 2,
                forks: 1,
                contributors: 1,
                complexity: 6,
                monthsActive: 7,
                isUnique: true,
                icon: '🔍',
                tags: ['security', 'tracking', 'anti-scam']
            }
        ];

        // Process projects and display
        async function initializeDashboard() {
            try {
                const tokenomics = window.projectTokenomics;
                const results = await tokenomics.processAllProjects(projects);
                const dashboard = tokenomics.generateDashboard(results);
                
                // Update stats
                document.getElementById('totalValue').textContent = 
                    '$' + dashboard.overview.totalValue.toLocaleString();
                document.getElementById('projectCount').textContent = 
                    dashboard.overview.totalProjects;
                document.getElementById('totalMarketCap').textContent = 
                    '$' + dashboard.overview.totalMarketCap.toLocaleString();
                
                // Calculate average ROI from actual results
                const avgROI = results.reduce((sum, r) => {
                    if (r.error) return sum;
                    return sum + (r.investment?.roi?.moderate || 5);
                }, 0) / results.filter(r => !r.error).length;
                document.getElementById('avgROI').textContent = avgROI.toFixed(1) + 'x';
                
                // Display projects
                const grid = document.getElementById('projectsGrid');
                grid.innerHTML = '';
                
                results.forEach(result => {
                    if (result.error) return;
                    
                    const card = document.createElement('div');
                    card.className = 'token-card';
                    card.innerHTML = `
                        <div class="token-header">
                            <div class="token-name">${result.project}</div>
                            <div class="token-symbol">${result.token.symbol}</div>
                        </div>
                        <div class="token-value">$${result.valuation.finalValue.toLocaleString()}</div>
                        <div class="risk-badge risk-${result.investment.riskLevel.toLowerCase().replace('_', '-')}">
                            Risk: ${result.investment.riskLevel}
                        </div>
                        <div class="token-metrics">
                            <div class="metric">
                                <div class="metric-label">Market Cap</div>
                                <div class="metric-value">$${(result.token.marketCap / 1000).toFixed(1)}K</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Token Price</div>
                                <div class="metric-value">$${result.token.initialPrice.toFixed(8)}</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Liquidity</div>
                                <div class="metric-value">$${(result.token.liquidity / 1000).toFixed(1)}K</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Potential ROI</div>
                                <div class="metric-value">${result.investment.roi.moderate}x</div>
                            </div>
                        </div>
                        <button class="invest-btn" onclick="investInProject('${result.pumpFun.pumpFunUrl}', '${result.token.symbol}')">
                            💸 INVEST IN ${result.token.symbol}
                        </button>
                        <div style="margin-top: 10px; font-size: 0.8em; color: #8affff; text-align: center;">
                            Mint: ${result.pumpFun.mintAddress.slice(0, 8)}...
                        </div>
                    `;
                    grid.appendChild(card);
                });
                
                // Show grid, hide loading
                document.getElementById('loading').style.display = 'none';
                document.getElementById('projectsGrid').style.display = 'grid';
                
            } catch (error) {
                console.error('Dashboard initialization error:', error);
                document.getElementById('loading').innerHTML = 
                    '<p style="color: #ff0000;">Error loading dashboard. Please refresh.</p>';
            }
        }

        function investInProject(pumpFunUrl, symbol) {
            // Check wallet connection
            if (!window.universalWalletAuth || !window.universalWalletAuth.isAuthenticated()) {
                alert('Please connect your wallet first!\n\nGo to the main hub and connect your Phantom or MetaMask wallet.');
                window.location.href = 'index.html';
                return;
            }
            
            // Open pump.fun (in production this would be the actual URL)
            alert(`Investing in ${symbol}!\n\nYou would be redirected to:\n${pumpFunUrl}\n\n(Feature coming soon - pump.fun integration pending)`);
            
            // In production:
            // window.open(pumpFunUrl, '_blank');
        }

        // Initialize on load with API integration
        window.addEventListener('DOMContentLoaded', async function() {
            // Add timestamp display
            addTimestampDisplay();
            
            // Fetch real-time Solana data
            const solanaData = await fetchSolanaMarketData();
            // Initialize dashboard
            await initializeDashboard();
            
            // Update timestamp
            updateTimestamp();
            
            // Set up auto-refresh
            setInterval(async () => {
                await initializeDashboard();
                updateTimestamp();
            }, UPDATE_INTERVAL);
        });
    </script>
</body>
</html>
