<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Realm Management - Collaborative Worlds</title>
  <link rel="stylesheet" href="public/styles.css">
  
  <!-- Universal Wallet Authentication -->
  <script src="../../fpds-contract-schema.js"></script>
  <script src="../../contractor-registry.js"></script>
  <script src="../../universal-wallet-auth.js"></script>
  <script src="../../auth-integration.js"></script>
</head>
<body>
  <script>
  // System Architect Only - Check on page load
  window.addEventListener('DOMContentLoaded', async () => {
      try {
          await window.authIntegration.init({ showUI: false });
          
          // Require System Architect access
          if (!window.universalWalletAuth.isSystemArchitect()) {
              alert('⛔ ACCESS DENIED\n\nSystem Architect credentials required.\n\nThis page is restricted to authorized System Architects only.');
              window.location.href = 'index.html';
              return;
          }
          
          console.log('✅ System Architect access granted - Realm Management');
      } catch (error) {
          console.error('❌ Auth error:', error);
          window.location.href = 'login.html';
      }
  });
  </script>
  <header>
    <h1>Realm Management</h1>
    <nav>
      <a href="index.html">Home</a> |
      <a href="profile.html">Profile</a> |
      <a href="forge.html">Forge</a> |
      <a href="grand_exchange.html">Grand Exchange</a>
    </nav>
  </header>
  <main>
    <section id="myRealmsSection" style="margin:2em 0;">
      <h2>My Realms & Assets</h2>
      <div id="myRealmsGrid" style="display:flex;flex-wrap:wrap;gap:18px;"></div>
    </section>
    <section id="collabRealmSection" style="margin:2em 0;">
      <h2>Collaborating On</h2>
      <div id="collabRealmsGrid" style="display:flex;flex-wrap:wrap;gap:18px;"></div>
    </section>
    <div id="realmModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.8);z-index:6000;align-items:center;justify-content:center;">
      <div style="background:#222;padding:1.5em 1em;border-radius:12px;max-width:95vw;width:480px;text-align:center;position:relative;">
        <button id="closeRealmModal" style="position:absolute;top:8px;right:12px;font-size:20px;background:none;border:none;color:#fff;cursor:pointer;">&times;</button>
        <h3 id="realmModalName"></h3>
        <div id="realmModalMeta" style="color:#aaa;font-size:13px;margin-top:8px;"></div>
        <div id="realmCollaborators"></div>
        <div id="realmInviteControls" style="margin-top:1em;"></div>
        <div id="realmModalStatus" style="margin-top:1em;color:#0f6;"></div>
      </div>
    </div>
  </main>
  <script src="realm_management.js"></script>
</body>
</html>
