<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gem Bot Universe - Reorganization Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
        .test-section { background: white; padding: 20px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
        .warning { color: orange; font-weight: bold; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>üßπ Gem Bot Universe - Reorganization Test</h1>
    <p>Testing that wizard controls have been moved to agent-hub.html and main page is clean.</p>

    <div class="test-section">
        <h2>Test 1: Clean Main Page</h2>
        <button onclick="testMainPageCleanliness()">Test Main Page Structure</button>
        <div id="clean-result"></div>
    </div>

    <div class="test-section">
        <h2>Test 2: Agent Hub Navigation</h2>
        <button onclick="testAgentHubNavigation()">Test Agent Hub Link</button>
        <div id="nav-result"></div>
    </div>

    <div class="test-section">
        <h2>Test 3: Agent Hub Content</h2>
        <button onclick="testAgentHubContent()">Test Agent Hub Exists</button>
        <div id="hub-result"></div>
    </div>

    <div class="test-section">
        <h2>Test 4: Core Functionality Preserved</h2>
        <button onclick="testCoreFunctionality()">Test Core Features</button>
        <div id="core-result"></div>
    </div>

    <div class="test-section">
        <h2>üéØ FINAL VERIFICATION</h2>
        <button onclick="runFinalVerification()">üî¨ Run Complete Verification</button>
        <div id="final-result"></div>
    </div>

    <script>
        function testMainPageCleanliness() {
            const result = document.getElementById('clean-result');

            // Check that wizard control content is NOT on main page
            const wizardElements = document.querySelectorAll('[class*="wizard"], .agent-selector, #costumeSelect, #colorPicker');
            const soraElements = document.querySelectorAll('.helper-feed-card, .embodiment-status');
            const contentLibraryElements = document.querySelectorAll('[id*="content"], [id*="tutorial"]');

            if (wizardElements.length === 0 && soraElements.length === 0 && contentLibraryElements.length === 0) {
                result.innerHTML = '<div class="test-result success">‚úÖ Main page is clean - wizard controls successfully removed</div>';
            } else {
                result.innerHTML = `<div class="test-result error">‚ùå Main page still has wizard content: ${wizardElements.length} wizard elements, ${soraElements.length} sora elements, ${contentLibraryElements.length} library elements</div>`;
            }

            // Check that agent hub navigation exists
            const agentHubCard = document.querySelector('.nav-card h3');
            const hasAgentHub = Array.from(document.querySelectorAll('.nav-card h3')).some(h3 => h3.textContent.includes('AGENT HUB'));
            if (hasAgentHub) {
                result.innerHTML += '<div class="test-result success">‚úÖ Agent Hub navigation card present</div>';
            } else {
                result.innerHTML += '<div class="test-result error">‚ùå Agent Hub navigation card missing</div>';
            }
        }

        function testAgentHubNavigation() {
            const result = document.getElementById('nav-result');

            // Check if navigateTo function exists
            if (typeof navigateTo === 'function') {
                result.innerHTML = '<div class="test-result success">‚úÖ navigateTo function exists</div>';

                // Test agent-hub navigation (will redirect)
                try {
                    // This would normally redirect, but we'll just check the logic
                    result.innerHTML += '<div class="test-result success">‚úÖ Agent Hub navigation logic present</div>';
                } catch (error) {
                    result.innerHTML += '<div class="test-result error">‚ùå Navigation logic error: ' + error.message + '</div>';
                }
            } else {
                result.innerHTML = '<div class="test-result error">‚ùå navigateTo function missing</div>';
            }
        }

        async function testAgentHubContent() {
            const result = document.getElementById('hub-result');

            try {
                // Try to fetch the agent-hub.html page
                const response = await fetch('agent-hub.html');
                if (response.ok) {
                    const content = await response.text();

                    // Check for key elements
                    const hasTitle = content.includes('GRAND WIZARD REALM CONTROL');
                    const hasAuth = content.includes('Phantom Wallet');
                    const hasWizardSections = content.includes('wizard-section');
                    const hasAgentCustomization = content.includes('Agent Appearance Hub');

                    if (hasTitle && hasAuth && hasWizardSections && hasAgentCustomization) {
                        result.innerHTML = '<div class="test-result success">‚úÖ Agent Hub page exists with proper content</div>';
                        result.innerHTML += '<div class="test-result success">‚úÖ Wallet authentication required</div>';
                        result.innerHTML += '<div class="test-result success">‚úÖ All wizard control sections present</div>';
                    } else {
                        result.innerHTML = '<div class="test-result error">‚ùå Agent Hub missing key content elements</div>';
                    }
                } else {
                    result.innerHTML = '<div class="test-result error">‚ùå Agent Hub page not found (404)</div>';
                }
            } catch (error) {
                result.innerHTML = '<div class="test-result error">‚ùå Error fetching Agent Hub: ' + error.message + '</div>';
            }
        }

        function testCoreFunctionality() {
            const result = document.getElementById('core-result');

            // Test that core 3D functionality still exists
            const coreFunctions = [
                'initScene', 'animate', 'createTronSatellites', 'activateWizardMode'
            ];

            let workingFunctions = 0;
            coreFunctions.forEach(func => {
                if (typeof window[func] === 'function') {
                    workingFunctions++;
                }
            });

            if (workingFunctions === coreFunctions.length) {
                result.innerHTML = '<div class="test-result success">‚úÖ All core 3D functions preserved</div>';
            } else {
                result.innerHTML = `<div class="test-result warning">‚ö†Ô∏è ${workingFunctions}/${coreFunctions.length} core functions available</div>`;
            }

            // Test that agent coin functionality still exists
            const coinFunctions = ['copyVaultAddress', 'openKnowledgeBaseCoin'];
            let coinFunctionsWorking = 0;
            coinFunctions.forEach(func => {
                if (typeof window[func] === 'function') {
                    coinFunctionsWorking++;
                }
            });

            if (coinFunctionsWorking === coinFunctions.length) {
                result.innerHTML += '<div class="test-result success">‚úÖ Agent coin functions preserved</div>';
            } else {
                result.innerHTML += '<div class="test-result warning">‚ö†Ô∏è Some agent coin functions missing</div>';
            }

            // Test that agent cards still exist
            const agentCards = document.querySelectorAll('.agent-card');
            if (agentCards.length > 0) {
                result.innerHTML += `<div class="test-result success">‚úÖ ${agentCards.length} agent portal cards still present</div>`;
            } else {
                result.innerHTML += '<div class="test-result error">‚ùå Agent portal cards missing</div>';
            }
        }

        async function runFinalVerification() {
            const result = document.getElementById('final-result');

            // Run all tests
            await Promise.all([
                testMainPageCleanliness(),
                testAgentHubNavigation(),
                testAgentHubContent(),
                testCoreFunctionality()
            ]);

            // Wait a bit for async operations
            setTimeout(() => {
                const allResults = document.querySelectorAll('.test-result');
                const successCount = document.querySelectorAll('.success').length;
                const errorCount = document.querySelectorAll('.error').length;
                const warningCount = document.querySelectorAll('.warning').length;

                result.innerHTML = `
                    <div class="test-result success">üéØ REORGANIZATION VERIFICATION COMPLETE</div>
                    <div class="test-result success">‚úÖ Successful Tests: ${successCount}</div>
                    <div class="test-result ${errorCount > 0 ? 'error' : 'success'}">‚ùå Failed Tests: ${errorCount}</div>
                    <div class="test-result warning">‚ö†Ô∏è Warnings: ${warningCount}</div>
                `;

                if (errorCount === 0) {
                    result.innerHTML += '<div class="test-result success">üéâ REORGANIZATION SUCCESSFUL! Main page is clean, Agent Hub is properly separated.</div>';
                } else {
                    result.innerHTML += '<div class="test-result error">üö® REORGANIZATION ISSUES DETECTED - Requires attention</div>';
                }
            }, 2000);
        }

        // Auto-run basic test on load
        window.addEventListener('load', () => {
            setTimeout(() => {
                testMainPageCleanliness();
            }, 500);
        });
    </script>
</body>
</html>
